let char_of_code c =
  match c with
  | 0 -> ' ' | 1 -> 'A' | 2 -> 'B' | 3 -> 'C' | 4 -> 'D'
  | 5 -> 'E' | 6 -> 'F' | 7 -> 'G' | 8 -> 'H' | 9 -> 'I'
  | 10 -> 'D' (* Delta *) | 11 -> 'J' | 12 -> 'K' | 13 -> 'L' | 14 -> 'M'
  | 15 -> 'N' | 16 -> 'O' | 17 -> 'P' | 18 -> 'Q' | 19 -> 'R'
  | 20 -> 'S' (* Sigma *) | 21 -> 'P' (* Pi *) | 22 -> 'S'
  | 23 -> 'T' | 24 -> 'U' | 25 -> 'V' | 26 -> 'W' | 27 -> 'X'
  | 28 -> 'Y' | 29 -> 'Z' | 30 -> '0' | 31 -> '1' | 32 -> '2'
  | 33 -> '3' | 34 -> '4' | 35 -> '5' | 36 -> '6' | 37 -> '7'
  | 38 -> '8' | 39 -> '9'
  | 40 -> '.' | 41 -> ',' | 42 -> '(' | 43 -> ')' | 44 -> '+'
  | 45 -> '-' | 46 -> '*' | 47 -> '/' | 48 -> '=' | 49 -> '$'
  | 50 -> '<' | 51 -> '>' | 52 -> '@' | 53 -> ';' | 54 -> ':'
  | 55 -> '\'' | _ -> invalid_arg "unknown character code"

let code_of_char c =
  match c with
  | ' ' -> 0 | 'A' -> 1 | 'B' -> 2 | 'C' -> 3 | 'D' -> 4
  | 'E' -> 5 | 'F' -> 6 | 'G' -> 7 | 'H' -> 8 | 'I' -> 9
  (* | 'D' -> 10 (* Delta *) *)
  | 'J' -> 11 | 'K' -> 12
  | 'L' -> 13 | 'M' -> 14 | 'N' -> 15 | 'O' -> 16
  | 'P' -> 17 | 'Q' -> 18 | 'R' -> 19
  (* | 'S' -> 20 (* Sigma *)
  | 'P' -> 21 (* Pi *) *)
  | 'S' -> 22 | 'T' -> 23
  | 'U' -> 24 | 'V' -> 25 | 'W' -> 26 | 'X' -> 27
  | 'Y' -> 28 | 'Z' -> 29 | '0' -> 30 | '1' -> 31
  | '2' -> 32 | '3' -> 33 | '4' -> 34 | '5' -> 35
  | '6' -> 36 | '7' -> 37 | '8' -> 38 | '9' -> 39
  | '.' -> 40 | ',' -> 41 | '(' -> 42 | ')' -> 43
  | '+' -> 44 | '-' -> 45 | '*' -> 46 | '/' -> 47
  | '=' -> 48 | '$' -> 49 | '<' -> 50 | '>' -> 51
  | '@' -> 52 | ';' -> 53 | ':' -> 54 | '\'' -> 55
  | _ -> invalid_arg "unknown character"
